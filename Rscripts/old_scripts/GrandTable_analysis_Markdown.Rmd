---
title: "Effect of Age on Frequency Band Events and its Relationship to Task Performance"
author: "Shane McKeon"
date: "3/12/2020"
geometry: margin = 1in
output:
  pdf_document:  
    toc: true
    toc_depth: 4    
    fig_caption: yes
  latex_engine: xelatex

  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, dev='png', dpi=150, fig.width = 6, fig.height=6, fig.align = 'left', fig.margin = TRUE)

```


```{r, echo= FALSE, message = FALSE, warning = FALSE}

if (!require("pacman")) install.packages("pacman")
pacman::p_load(dplyr, ggplot2,lme4, multcomp, tidyr, tidyverse,wesanderson, reshape2, corrplot, ggExtra, cowplot, ggsci, mgcv, ggpointdensity, devtools, ggpubr, itsadug, useful, rmarkdown, tinytex, gratia, gamm4, car, GGally, CCA)

#devtools::install_github('LabneuroCogDevel/LNCDR')
library(devtools)
#devtools::install_github("strengejacke/sjPlot")
library(LNCDR)
library(data.table)


GammaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay1_2/Gamma_all_data.csv')
AlphaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay1_2/Alpha_all_data.csv')
BetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay1_2/Beta_all_data.csv')
ThetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay1_2/Theta_all_data.csv')
agefile <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/agefile.csv')
agefile$Subject <- agefile$idvalues 

GrandTable <- merge(GammaT, AlphaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, BetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, ThetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

GrandTable$log10_Gamma_Trial_Power <- log10(GrandTable$Gamma_Trial_Power)
GrandTable$log10_Theta_Trial_Power <- log10(GrandTable$Theta_Trial_Power)
GrandTable$log10_Beta_Trial_Power <- log10(GrandTable$Beta_Trial_Power)
GrandTable$log10_Alpha_Trial_Power <- log10(GrandTable$Alpha_Trial_Power)


Behavior <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Behavior.csv')

Behavior$Subject <- paste0(Behavior$LunaID, '_', Behavior$ScanDate)
Behavior <- merge(Behavior, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

Everything <- merge(GrandTable, Behavior, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
Everything$absPositionError <- abs(Everything$PositionError)

## average across trials 
#gamma
Avg_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], mean)
TrialVar_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], sd)
PerSubjectGamma <- merge(Avg_log10_gamma_power, TrialVar_log10_gamma_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectGamma <- merge(PerSubjectGamma, agefile, by= 'Subject')

Avg_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, mean)
TrialVar_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, mean)
TrialVar_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectGamma$ageInverse = 1/PerSubjectGamma$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


#alpha
Avg_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], mean)
TrialVar_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], sd)
PerSubjectAlpha <- merge(Avg_log10_alpha_power, TrialVar_log10_alpha_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectAlpha <- merge(PerSubjectAlpha, agefile, by= 'Subject')

Avg_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, mean)
TrialVar_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, mean)
TrialVar_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectAlpha$ageInverse = 1/PerSubjectAlpha$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#theta
Avg_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], mean)
TrialVar_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], sd)
PerSubjectTheta <- merge(Avg_log10_theta_power, TrialVar_log10_theta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectTheta <- merge(PerSubjectTheta, agefile, by= 'Subject')

Avg_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, mean)
TrialVar_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, mean)
TrialVar_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectTheta$ageInverse = 1/PerSubjectTheta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#beta
Avg_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], mean)
TrialVar_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], sd)
PerSubjectBeta <- merge(Avg_log10_beta_power, TrialVar_log10_beta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectBeta <- merge(PerSubjectBeta, agefile, by= 'Subject')

Avg_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, mean)
TrialVar_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, mean)
TrialVar_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectBeta$ageInverse = 1/PerSubjectBeta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


## plots
#frequency vs age 
```

# Delay Period 1-2 Seconds: Frequency Bands Across Age
## Gamma Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE, fig.margin = TRUE}
#gamma

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")

lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Average Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ ageInverse)
anova(lm.model)

```


## Alpha Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE}
#alpha
ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Theta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Beta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ ageInverse)
anova(lm.model)
```


# Delay Period 1-2 Seconds: Frequency Bands and Task Performance
## Fit Linear Mixed Effects Model
### Gamma Band Frequency
#### Effect of Gamma Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Gamma Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

### Alpha Band Frequency
#### Effect of Alpha Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Alpha Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Theta Band Frequency
#### Effect of Theta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Theta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Beta Band Frequency
#### Effect of Beta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Beta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


## Gamma Frequency Band
### Position Error

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,],  aes(x = absPositionError, y = log10_Gamma_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,], log10_Gamma_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,],  aes(x = absPositionError, y = log10_Gamma_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,], log10_Gamma_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,],  aes(x = absPositionError, y = Gamma_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,], Gamma_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,],  aes(x = absPositionError, y = Gamma_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,], Gamma_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,],  aes(x = absPositionError, y = Gamma_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,],  aes(x = absPositionError, y = Gamma_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20,], Gamma_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

#### Adult Subjects Only  
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,],  aes(x = absPositionError, y = log10_Gamma_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,], log10_Gamma_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,],  aes(x = absPositionError, y = log10_Gamma_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,], log10_Gamma_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,],  aes(x = absPositionError, y = Gamma_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,], Gamma_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,],  aes(x = absPositionError, y = Gamma_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,], Gamma_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,],  aes(x = absPositionError, y = Gamma_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,],  aes(x = absPositionError, y = Gamma_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$absPositionError < 20 & PerSubjectGamma$Group == 4,], Gamma_Event_Number_SD ~ absPositionError)
anova(lm.model)


```

### MGS Latency

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = mgsLatency, y = log10_Gamma_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = mgsLatency, y = log10_Gamma_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = mgsLatency, y = Gamma_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = mgsLatency, y = Gamma_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = mgsLatency, y = Gamma_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = mgsLatency, y = Gamma_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

#### Adults Subjects Only
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,],  aes(x = mgsLatency, y = log10_Gamma_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,], log10_Gamma_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,],  aes(x = mgsLatency, y = log10_Gamma_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,], log10_Gamma_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,],  aes(x = mgsLatency, y = Gamma_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,], Gamma_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,],  aes(x = mgsLatency, y = Gamma_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,], Gamma_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,],  aes(x = mgsLatency, y = Gamma_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Gamma Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,], Gamma_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,],  aes(x = mgsLatency, y = Gamma_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Gamma Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2 & PerSubjectGamma$Group == 4,], Gamma_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

## Alpha Frequency Band
### Position Error

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,],  aes(x = absPositionError, y = log10_Alpha_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,], log10_Alpha_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,],  aes(x = absPositionError, y = log10_Alpha_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,], log10_Alpha_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,],  aes(x = absPositionError, y = Alpha_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,], Alpha_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,],  aes(x = absPositionError, y = Alpha_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,], Alpha_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,],  aes(x = absPositionError, y = Alpha_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,],  aes(x = absPositionError, y = Alpha_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20,], Alpha_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

#### Adult Subjects Only
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,],  aes(x = absPositionError, y = log10_Alpha_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,], log10_Alpha_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,],  aes(x = absPositionError, y = log10_Alpha_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,], log10_Alpha_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,],  aes(x = absPositionError, y = Alpha_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,], Alpha_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,],  aes(x = absPositionError, y = Alpha_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,], Alpha_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,],  aes(x = absPositionError, y = Alpha_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,],  aes(x = absPositionError, y = Alpha_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$absPositionError < 20 & PerSubjectAlpha$Group == 4,], Alpha_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

### MGS Latency

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = mgsLatency, y = log10_Alpha_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = mgsLatency, y = log10_Alpha_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = mgsLatency, y = Alpha_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = mgsLatency, y = Alpha_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = mgsLatency, y = Alpha_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = mgsLatency, y = Alpha_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

#### Adult Subjects Only 
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,],  aes(x = mgsLatency, y = log10_Alpha_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,], log10_Alpha_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,],  aes(x = mgsLatency, y = log10_Alpha_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,], log10_Alpha_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,],  aes(x = mgsLatency, y = Alpha_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,], Alpha_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,],  aes(x = mgsLatency, y = Alpha_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,], Alpha_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,],  aes(x = mgsLatency, y = Alpha_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Alpha Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,], Alpha_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,],  aes(x = mgsLatency, y = Alpha_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Alpha Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2 & PerSubjectAlpha$Group == 4,], Alpha_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

## Theta Frequency Band
### Position Error

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,],  aes(x = absPositionError, y = log10_Theta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,], log10_Theta_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,],  aes(x = absPositionError, y = log10_Theta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,], log10_Theta_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,],  aes(x = absPositionError, y = Theta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,], Theta_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,],  aes(x = absPositionError, y = Theta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,], Theta_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,],  aes(x = absPositionError, y = Theta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,], Theta_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,],  aes(x = absPositionError, y = Theta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20,], Theta_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

#### Adult Subjects Only
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,],  aes(x = absPositionError, y = log10_Theta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,], log10_Theta_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,],  aes(x = absPositionError, y = log10_Theta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,], log10_Theta_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,],  aes(x = absPositionError, y = Theta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,], Theta_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,],  aes(x = absPositionError, y = Theta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,], Theta_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,],  aes(x = absPositionError, y = Theta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,], Theta_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,],  aes(x = absPositionError, y = Theta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$absPositionError < 20 & PerSubjectTheta$Group == 4,], Theta_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

### MGS Latency

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = mgsLatency, y = log10_Theta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = mgsLatency, y = log10_Theta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = mgsLatency, y = Theta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = mgsLatency, y = Theta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = mgsLatency, y = Theta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = mgsLatency, y = Theta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

#### Adult Subjects Only
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,],  aes(x = mgsLatency, y = log10_Theta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,], log10_Theta_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,],  aes(x = mgsLatency, y = log10_Theta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,], log10_Theta_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,],  aes(x = mgsLatency, y = Theta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,], Theta_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,],  aes(x = mgsLatency, y = Theta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,], Theta_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,],  aes(x = mgsLatency, y = Theta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Theta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,], Theta_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,],  aes(x = mgsLatency, y = Theta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Theta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2 & PerSubjectTheta$Group == 4,], Theta_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

## Beta Frequency Band
### Position Error

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,],  aes(x = absPositionError, y = log10_Beta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,], log10_Beta_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,],  aes(x = absPositionError, y = log10_Beta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,], log10_Beta_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,],  aes(x = absPositionError, y = Beta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,], Beta_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,],  aes(x = absPositionError, y = Beta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,], Beta_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,],  aes(x = absPositionError, y = Beta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,], Beta_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,],  aes(x = absPositionError, y = Beta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20,], Beta_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

#### Adult Subjects Only 
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,],  aes(x = absPositionError, y = log10_Beta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,], log10_Beta_Trial_Power_mean ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,],  aes(x = absPositionError, y = log10_Beta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Power vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,], log10_Beta_Trial_Power_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,],  aes(x = absPositionError, y = Beta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,], Beta_Event_Duration ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,],  aes(x = absPositionError, y = Beta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Duration vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,], Beta_Event_Duration_SD ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,],  aes(x = absPositionError, y = Beta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,], Beta_Event_Number ~ absPositionError)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,],  aes(x = absPositionError, y = Beta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Number vs Position Error") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Abs(Position Error)") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$absPositionError < 20 & PerSubjectBeta$Group == 4,], Beta_Event_Number_SD ~ absPositionError)
anova(lm.model)

```

### MGS Latency

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = mgsLatency, y = log10_Beta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = mgsLatency, y = log10_Beta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = mgsLatency, y = Beta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = mgsLatency, y = Beta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = mgsLatency, y = Beta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = mgsLatency, y = Beta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```

#### Adult Subjects Only 
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,],  aes(x = mgsLatency, y = log10_Beta_Trial_Power_mean )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,], log10_Beta_Trial_Power_mean ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,],  aes(x = mgsLatency, y = log10_Beta_Trial_Power_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Power vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,], log10_Beta_Trial_Power_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,],  aes(x = mgsLatency, y = Beta_Event_Duration )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,], Beta_Event_Duration ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,],  aes(x = mgsLatency, y = Beta_Event_Duration_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Duration vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,], Beta_Event_Duration_SD ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,],  aes(x = mgsLatency, y = Beta_Event_Number )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Average Trial Beta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,], Beta_Event_Number ~ mgsLatency)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,],  aes(x = mgsLatency, y = Beta_Event_Number_SD )) + geom_point(aes(color = age)) + scale_color_gradient2(low = "blue", high = "red") + stat_smooth(method='lm') + ggtitle("Between Trial Variability Beta Event Number vs Latency") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Latency") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2 & PerSubjectBeta$Group == 4,], Beta_Event_Number_SD ~ mgsLatency)
anova(lm.model)

```


```{r echo=FALSE, message=FALSE, warning=FALSE}
GammaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay2_3/Gamma_all_data2_3.csv')
AlphaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay2_3/Alpha_all_data2_3.csv')
BetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay2_3/Beta_all_data2_3.csv')
ThetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay2_3/Theta_all_data2_3.csv')
agefile <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/agefile.csv')
agefile$Subject <- agefile$idvalues 

GrandTable <- merge(GammaT, AlphaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, BetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, ThetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

GrandTable$log10_Gamma_Trial_Power <- log10(GrandTable$Gamma_Trial_Power)
GrandTable$log10_Theta_Trial_Power <- log10(GrandTable$Theta_Trial_Power)
GrandTable$log10_Beta_Trial_Power <- log10(GrandTable$Beta_Trial_Power)
GrandTable$log10_Alpha_Trial_Power <- log10(GrandTable$Alpha_Trial_Power)


Behavior <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Behavior.csv')

Behavior$Subject <- paste0(Behavior$LunaID, '_', Behavior$ScanDate)
Behavior <- merge(Behavior, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

Everything <- merge(GrandTable, Behavior, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
Everything$absPositionError <- abs(Everything$PositionError)

## average across trials 
#gamma
Avg_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], mean)
TrialVar_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], sd)
PerSubjectGamma <- merge(Avg_log10_gamma_power, TrialVar_log10_gamma_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectGamma <- merge(PerSubjectGamma, agefile, by= 'Subject')

Avg_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, mean)
TrialVar_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, mean)
TrialVar_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectGamma$ageInverse = 1/PerSubjectGamma$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


#alpha
Avg_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], mean)
TrialVar_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], sd)
PerSubjectAlpha <- merge(Avg_log10_alpha_power, TrialVar_log10_alpha_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectAlpha <- merge(PerSubjectAlpha, agefile, by= 'Subject')

Avg_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, mean)
TrialVar_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, mean)
TrialVar_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectAlpha$ageInverse = 1/PerSubjectAlpha$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#theta
Avg_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], mean)
TrialVar_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], sd)
PerSubjectTheta <- merge(Avg_log10_theta_power, TrialVar_log10_theta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectTheta <- merge(PerSubjectTheta, agefile, by= 'Subject')

Avg_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, mean)
TrialVar_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, mean)
TrialVar_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectTheta$ageInverse = 1/PerSubjectTheta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#beta
Avg_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], mean)
TrialVar_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], sd)
PerSubjectBeta <- merge(Avg_log10_beta_power, TrialVar_log10_beta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectBeta <- merge(PerSubjectBeta, agefile, by= 'Subject')

Avg_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, mean)
TrialVar_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, mean)
TrialVar_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectBeta$ageInverse = 1/PerSubjectBeta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


## plots
#frequency vs age 
```

# Delay Period 2-3 Seconds: Frequency Bands Across Age
## Gamma Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE, fig.margin = TRUE}
#gamma

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")

lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Average Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ ageInverse)
anova(lm.model)

```


## Alpha Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE}
#alpha
ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Theta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Beta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ ageInverse)
anova(lm.model)
```


# Delay Period 2-3 Seconds: Frequency Bands and Task Performance
## Fit Linear Mixed Effects Model
### Gamma Band Frequency
#### Effect of Gamma Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Gamma Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

### Alpha Band Frequency
#### Effect of Alpha Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Alpha Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Theta Band Frequency
#### Effect of Theta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Theta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Beta Band Frequency
#### Effect of Beta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Beta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```




```{r echo=FALSE, message=FALSE, warning=FALSE}
GammaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay3_4/Gamma_all_data3_4.csv')
AlphaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay3_4/Alpha_all_data3_4.csv')
BetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay3_4/Beta_all_data3_4.csv')
ThetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay3_4/Theta_all_data3_4.csv')
agefile <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/agefile.csv')
agefile$Subject <- agefile$idvalues 

GrandTable <- merge(GammaT, AlphaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, BetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, ThetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

GrandTable$log10_Gamma_Trial_Power <- log10(GrandTable$Gamma_Trial_Power)
GrandTable$log10_Theta_Trial_Power <- log10(GrandTable$Theta_Trial_Power)
GrandTable$log10_Beta_Trial_Power <- log10(GrandTable$Beta_Trial_Power)
GrandTable$log10_Alpha_Trial_Power <- log10(GrandTable$Alpha_Trial_Power)


Behavior <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Behavior.csv')

Behavior$Subject <- paste0(Behavior$LunaID, '_', Behavior$ScanDate)
Behavior <- merge(Behavior, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

Everything <- merge(GrandTable, Behavior, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
Everything$absPositionError <- abs(Everything$PositionError)

## average across trials 
#gamma
Avg_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], mean)
TrialVar_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], sd)
PerSubjectGamma <- merge(Avg_log10_gamma_power, TrialVar_log10_gamma_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectGamma <- merge(PerSubjectGamma, agefile, by= 'Subject')

Avg_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, mean)
TrialVar_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, mean)
TrialVar_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectGamma$ageInverse = 1/PerSubjectGamma$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


#alpha
Avg_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], mean)
TrialVar_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], sd)
PerSubjectAlpha <- merge(Avg_log10_alpha_power, TrialVar_log10_alpha_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectAlpha <- merge(PerSubjectAlpha, agefile, by= 'Subject')

Avg_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, mean)
TrialVar_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, mean)
TrialVar_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectAlpha$ageInverse = 1/PerSubjectAlpha$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#theta
Avg_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], mean)
TrialVar_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], sd)
PerSubjectTheta <- merge(Avg_log10_theta_power, TrialVar_log10_theta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectTheta <- merge(PerSubjectTheta, agefile, by= 'Subject')

Avg_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, mean)
TrialVar_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, mean)
TrialVar_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectTheta$ageInverse = 1/PerSubjectTheta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#beta
Avg_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], mean)
TrialVar_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], sd)
PerSubjectBeta <- merge(Avg_log10_beta_power, TrialVar_log10_beta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectBeta <- merge(PerSubjectBeta, agefile, by= 'Subject')

Avg_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, mean)
TrialVar_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, mean)
TrialVar_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectBeta$ageInverse = 1/PerSubjectBeta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


## plots
#frequency vs age 
```


# Delay Period 3-4 Seconds: Frequency Bands Across Age
## Gamma Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE, fig.margin = TRUE}
#gamma

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")

lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Average Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ ageInverse)
anova(lm.model)

```


## Alpha Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE}
#alpha
ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Theta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Beta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ ageInverse)
anova(lm.model)
```


# Delay Period 3-4 Seconds: Frequency Bands and Task Performance
## Fit Linear Mixed Effects Model
### Gamma Band Frequency
#### Effect of Gamma Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Gamma Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

### Alpha Band Frequency
#### Effect of Alpha Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Alpha Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Theta Band Frequency
#### Effect of Theta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Theta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Beta Band Frequency
#### Effect of Beta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Beta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```




```{r echo=FALSE, message=FALSE, warning=FALSE}
GammaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay4_5/Gamma_all_data4_5.csv')
AlphaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay4_5/Alpha_all_data4_5.csv')
BetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay4_5/Beta_all_data4_5.csv')
ThetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay4_5/Theta_all_data4_5.csv')
agefile <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/agefile.csv')
agefile$Subject <- agefile$idvalues 

GrandTable <- merge(GammaT, AlphaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, BetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, ThetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

GrandTable$log10_Gamma_Trial_Power <- log10(GrandTable$Gamma_Trial_Power)
GrandTable$log10_Theta_Trial_Power <- log10(GrandTable$Theta_Trial_Power)
GrandTable$log10_Beta_Trial_Power <- log10(GrandTable$Beta_Trial_Power)
GrandTable$log10_Alpha_Trial_Power <- log10(GrandTable$Alpha_Trial_Power)


Behavior <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Behavior.csv')

Behavior$Subject <- paste0(Behavior$LunaID, '_', Behavior$ScanDate)
Behavior <- merge(Behavior, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

Everything <- merge(GrandTable, Behavior, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
Everything$absPositionError <- abs(Everything$PositionError)

## average across trials 
#gamma
Avg_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], mean)
TrialVar_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], sd)
PerSubjectGamma <- merge(Avg_log10_gamma_power, TrialVar_log10_gamma_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectGamma <- merge(PerSubjectGamma, agefile, by= 'Subject')

Avg_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, mean)
TrialVar_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, mean)
TrialVar_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectGamma$ageInverse = 1/PerSubjectGamma$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


#alpha
Avg_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], mean)
TrialVar_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], sd)
PerSubjectAlpha <- merge(Avg_log10_alpha_power, TrialVar_log10_alpha_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectAlpha <- merge(PerSubjectAlpha, agefile, by= 'Subject')

Avg_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, mean)
TrialVar_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, mean)
TrialVar_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectAlpha$ageInverse = 1/PerSubjectAlpha$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#theta
Avg_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], mean)
TrialVar_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], sd)
PerSubjectTheta <- merge(Avg_log10_theta_power, TrialVar_log10_theta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectTheta <- merge(PerSubjectTheta, agefile, by= 'Subject')

Avg_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, mean)
TrialVar_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, mean)
TrialVar_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectTheta$ageInverse = 1/PerSubjectTheta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#beta
Avg_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], mean)
TrialVar_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], sd)
PerSubjectBeta <- merge(Avg_log10_beta_power, TrialVar_log10_beta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectBeta <- merge(PerSubjectBeta, agefile, by= 'Subject')

Avg_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, mean)
TrialVar_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, mean)
TrialVar_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectBeta$ageInverse = 1/PerSubjectBeta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


## plots
#frequency vs age 
```


# Delay Period 4-5 Seconds: Frequency Bands Across Age
## Gamma Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE, fig.margin = TRUE}
#gamma

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")

lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Average Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ ageInverse)
anova(lm.model)

```


## Alpha Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE}
#alpha
ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Theta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Beta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ ageInverse)
anova(lm.model)
```


# Delay Period 4-5 Seconds: Frequency Bands and Task Performance
## Fit Linear Mixed Effects Model
### Gamma Band Frequency
#### Effect of Gamma Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Gamma Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

### Alpha Band Frequency
#### Effect of Alpha Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Alpha Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Theta Band Frequency
#### Effect of Theta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Theta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Beta Band Frequency
#### Effect of Beta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Beta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```




```{r echo=FALSE, message=FALSE, warning=FALSE}
GammaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay5_6/Gamma_all_data5_6.csv')
AlphaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay5_6/Alpha_all_data5_6.csv')
BetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay5_6/Beta_all_data5_6.csv')
ThetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay5_6/Theta_all_data5_6.csv')
agefile <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/agefile.csv')
agefile$Subject <- agefile$idvalues 

GrandTable <- merge(GammaT, AlphaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, BetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, ThetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

GrandTable$log10_Gamma_Trial_Power <- log10(GrandTable$Gamma_Trial_Power)
GrandTable$log10_Theta_Trial_Power <- log10(GrandTable$Theta_Trial_Power)
GrandTable$log10_Beta_Trial_Power <- log10(GrandTable$Beta_Trial_Power)
GrandTable$log10_Alpha_Trial_Power <- log10(GrandTable$Alpha_Trial_Power)


Behavior <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Behavior.csv')

Behavior$Subject <- paste0(Behavior$LunaID, '_', Behavior$ScanDate)
Behavior <- merge(Behavior, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

Everything <- merge(GrandTable, Behavior, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
Everything$absPositionError <- abs(Everything$PositionError)

## average across trials 
#gamma
Avg_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], mean)
TrialVar_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], sd)
PerSubjectGamma <- merge(Avg_log10_gamma_power, TrialVar_log10_gamma_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectGamma <- merge(PerSubjectGamma, agefile, by= 'Subject')

Avg_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, mean)
TrialVar_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, mean)
TrialVar_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectGamma$ageInverse = 1/PerSubjectGamma$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


#alpha
Avg_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], mean)
TrialVar_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], sd)
PerSubjectAlpha <- merge(Avg_log10_alpha_power, TrialVar_log10_alpha_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectAlpha <- merge(PerSubjectAlpha, agefile, by= 'Subject')

Avg_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, mean)
TrialVar_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, mean)
TrialVar_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectAlpha$ageInverse = 1/PerSubjectAlpha$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#theta
Avg_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], mean)
TrialVar_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], sd)
PerSubjectTheta <- merge(Avg_log10_theta_power, TrialVar_log10_theta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectTheta <- merge(PerSubjectTheta, agefile, by= 'Subject')

Avg_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, mean)
TrialVar_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, mean)
TrialVar_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectTheta$ageInverse = 1/PerSubjectTheta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#beta
Avg_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], mean)
TrialVar_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], sd)
PerSubjectBeta <- merge(Avg_log10_beta_power, TrialVar_log10_beta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectBeta <- merge(PerSubjectBeta, agefile, by= 'Subject')

Avg_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, mean)
TrialVar_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, mean)
TrialVar_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectBeta$ageInverse = 1/PerSubjectBeta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


## plots
#frequency vs age 
```


# Delay Period 5-6 Seconds: Frequency Bands Across Age
## Gamma Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE, fig.margin = TRUE}
#gamma

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")

lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Average Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ ageInverse)
anova(lm.model)

```


## Alpha Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE}
#alpha
ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Theta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Beta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ ageInverse)
anova(lm.model)
```


# Delay Period 5-6 Seconds: Frequency Bands and Task Performance
## Fit Linear Mixed Effects Model
### Gamma Band Frequency
#### Effect of Gamma Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Gamma Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Gamma_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Gamma_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Gamma Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```
#### Effect of Average Gamma Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Gamma_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

### Alpha Band Frequency
#### Effect of Alpha Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Alpha Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Alpha_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Alpha_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Alpha Event Duration on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Alpha_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Theta Band Frequency
#### Effect of Theta Trial Power on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Theta Trial Power on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Theta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Theta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on Position Error 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Number on MGS Latency
```{r echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on Position Error 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Theta Event Duration on MGS Latency
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Theta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


### Beta Band Frequency
#### Effect of Beta Trial Power on Position Error 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Beta Trial Power on MGS Latency
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + log10_Beta_Trial_Power + (1|Subject), data = Everything[Everything$visitno.x < 2 & Everything$log10_Beta_Trial_Power != '-Inf',])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on Position Error 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Number on MGS Latency
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Number + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on Position Error 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(absPositionError ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```

#### Effect of Average Beta Event Duration on MGS Latency
```{r, echo=FALSE, message=FALSE, warning=FALSE}
Everything$Subject <- as.factor(Everything$Subject)
modelFit <- lmer(mgsLatency ~ age.x + Beta_Event_Duration + (1|Subject), data = Everything[Everything$visitno.x < 2,])
car::Anova(modelFit)
```


# Comparing the Delay Periods 
## Gamma Frequency Band 
### Across Time
```{r  echo=FALSE, message=FALSE, warning=FALSE}
GammaDelay1_2 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay1_2/Gamma_all_data.csv')
GammaDelay2_3 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay2_3/Gamma_all_data2_3.csv')
GammaDelay3_4 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay3_4/Gamma_all_data3_4.csv')
GammaDelay4_5 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay4_5/Gamma_all_data4_5.csv')
GammaDelay5_6 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Delay5_6/Gamma_all_data5_6.csv')

GammaDelay1_2$log10_Gamma_Trial_Power <- log10(GammaDelay1_2$Gamma_Trial_Power)
GammaDelay2_3$log10_Gamma_Trial_Power <- log10(GammaDelay2_3$Gamma_Trial_Power)
GammaDelay3_4$log10_Gamma_Trial_Power <- log10(GammaDelay3_4$Gamma_Trial_Power)
GammaDelay4_5$log10_Gamma_Trial_Power <- log10(GammaDelay4_5$Gamma_Trial_Power)
GammaDelay5_6$log10_Gamma_Trial_Power <- log10(GammaDelay5_6$Gamma_Trial_Power)

Avg_power1_2 <- aggregate(log10_Gamma_Trial_Power~ Subject, GammaDelay1_2[GammaDelay1_2$Gamma_Trial_Power > 0,], mean)
Avg_power2_3 <- aggregate(log10_Gamma_Trial_Power~ Subject, GammaDelay2_3[GammaDelay2_3$Gamma_Trial_Power > 0,], mean)
Avg_power3_4 <- aggregate(log10_Gamma_Trial_Power~ Subject, GammaDelay3_4[GammaDelay3_4$Gamma_Trial_Power > 0,], mean)
Avg_power4_5 <- aggregate(log10_Gamma_Trial_Power~ Subject, GammaDelay4_5[GammaDelay4_5$Gamma_Trial_Power > 0,], mean)
Avg_power5_6 <- aggregate(log10_Gamma_Trial_Power~ Subject, GammaDelay5_6[GammaDelay5_6$Gamma_Trial_Power > 0,], mean)


Avg_GammaDelay1_2 <- setNames(aggregate(list(GammaDelay1_2$Gamma_Event_Number, GammaDelay1_2$Gamma_Event_Duration), by = list(GammaDelay1_2$Subject),mean), c("Subject", "Gamma_Event_Number","Gamma_Event_Duration"))
Avg_GammaDelay1_2 <- merge(Avg_GammaDelay1_2, Avg_power1_2, by = "Subject")


Avg_GammaDelay2_3 <- setNames(aggregate(list(GammaDelay2_3$Gamma_Event_Number, GammaDelay2_3$Gamma_Event_Duration), by = list(GammaDelay2_3$Subject),mean), c("Subject", "Gamma_Event_Number","Gamma_Event_Duration"))
Avg_GammaDelay2_3 <- merge(Avg_GammaDelay2_3, Avg_power2_3, by = "Subject")


Avg_GammaDelay3_4 <- setNames(aggregate(list(GammaDelay3_4$Gamma_Event_Number, GammaDelay3_4$Gamma_Event_Duration), by = list(GammaDelay3_4$Subject),mean), c("Subject", "Gamma_Event_Number","Gamma_Event_Duration"))
Avg_GammaDelay3_4 <- merge(Avg_GammaDelay3_4, Avg_power3_4, by = "Subject")


Avg_GammaDelay4_5 <- setNames(aggregate(list(GammaDelay4_5$Gamma_Event_Number, GammaDelay4_5$Gamma_Event_Duration), by = list(GammaDelay4_5$Subject),mean), c("Subject",  "Gamma_Event_Number","Gamma_Event_Duration"))
Avg_GammaDelay4_5 <- merge(Avg_GammaDelay4_5, Avg_power4_5, by = "Subject")


Avg_GammaDelay5_6 <- setNames(aggregate(list( GammaDelay5_6$Gamma_Event_Number, GammaDelay5_6$Gamma_Event_Duration), by = list(GammaDelay5_6$Subject),mean), c("Subject", "Gamma_Event_Number","Gamma_Event_Duration"))
Avg_GammaDelay5_6 <- merge(Avg_GammaDelay5_6, Avg_power5_6, by = "Subject")


Avg_GammaDelay1_2$epoch <- "1-2"
Avg_GammaDelay2_3$epoch <- "2-3"
Avg_GammaDelay3_4$epoch <- "3-4"
Avg_GammaDelay4_5$epoch <- "4-5"
Avg_GammaDelay5_6$epoch <- "5-6"

allDelayGamma <- rbind(Avg_GammaDelay1_2, Avg_GammaDelay2_3)
allDelayGamma <- rbind(allDelayGamma, Avg_GammaDelay3_4)
allDelayGamma <- rbind(allDelayGamma, Avg_GammaDelay4_5)
allDelayGamma <- rbind(allDelayGamma, Avg_GammaDelay5_6)
allDelayGamma <- merge(allDelayGamma, agefile, by = "Subject")
allDelayGamma <- subset(allDelayGamma, visitno < 2)

DelayGammabyGroup <- setNames(aggregate(list(allDelayGamma$log10_Gamma_Trial_Power, allDelayGamma$Gamma_Event_Number, allDelayGamma$Gamma_Event_Duration), by = list(allDelayGamma$Group, allDelayGamma$epoch),mean), c("Group","Epoch", "Gamma_Trial_Power", "Gamma_Event_Number","Gamma_Event_Duration"))

ggplot(data = DelayGammabyGroup,  aes(x = Epoch, y = Gamma_Trial_Power,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Gamma Power across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Power")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old


```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayGammabyGroup, Gamma_Trial_Power ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayGammabyGroup,  aes(x = Epoch, y = Gamma_Event_Number,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm')+ ggtitle("Average Number of Gamma Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Number of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old


```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayGammabyGroup, Gamma_Event_Number ~ Epoch + Group)
anova(lm.model)
```


```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayGammabyGroup,  aes(x = Epoch, y = Gamma_Event_Duration,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + stat_smooth(method='lm') + ggtitle("Average Duration of Gamma Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Duration of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old


```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayGammabyGroup, Gamma_Event_Duration ~ Epoch + Group)
anova(lm.model)
```

### Across Age
```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = allDelayGamma,  aes(x = age, y = log10_Gamma_Trial_Power,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Power across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = allDelayGamma,  aes(x = age, y = Gamma_Event_Number,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Number of Gamma Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = allDelayGamma,  aes(x = age, y = Gamma_Event_Duration,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Duration of Gamma Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events")
```



## Alpha Frequency Band 
### Across Time
```{r  echo=FALSE, message=FALSE, warning=FALSE}
AlphaDelay1_2 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay1_2/Alpha_all_data.csv')
AlphaDelay2_3 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay2_3/Alpha_all_data2_3.csv')
AlphaDelay3_4 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay3_4/Alpha_all_data3_4.csv')
AlphaDelay4_5 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay4_5/Alpha_all_data4_5.csv')
AlphaDelay5_6 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Delay5_6/Alpha_all_data5_6.csv')

AlphaDelay1_2$log10_Alpha_Trial_Power <- log10(AlphaDelay1_2$Alpha_Trial_Power)
AlphaDelay2_3$log10_Alpha_Trial_Power <- log10(AlphaDelay2_3$Alpha_Trial_Power)
AlphaDelay3_4$log10_Alpha_Trial_Power <- log10(AlphaDelay3_4$Alpha_Trial_Power)
AlphaDelay4_5$log10_Alpha_Trial_Power <- log10(AlphaDelay4_5$Alpha_Trial_Power)
AlphaDelay5_6$log10_Alpha_Trial_Power <- log10(AlphaDelay5_6$Alpha_Trial_Power)

Avg_power1_2 <- aggregate(log10_Alpha_Trial_Power~ Subject, AlphaDelay1_2[AlphaDelay1_2$Alpha_Trial_Power > 0,], mean)
Avg_power2_3 <- aggregate(log10_Alpha_Trial_Power~ Subject, AlphaDelay2_3[AlphaDelay2_3$Alpha_Trial_Power > 0,], mean)
Avg_power3_4 <- aggregate(log10_Alpha_Trial_Power~ Subject, AlphaDelay3_4[AlphaDelay3_4$Alpha_Trial_Power > 0,], mean)
Avg_power4_5 <- aggregate(log10_Alpha_Trial_Power~ Subject, AlphaDelay4_5[AlphaDelay4_5$Alpha_Trial_Power > 0,], mean)
Avg_power5_6 <- aggregate(log10_Alpha_Trial_Power~ Subject, AlphaDelay5_6[AlphaDelay5_6$Alpha_Trial_Power > 0,], mean)


Avg_AlphaDelay1_2 <- setNames(aggregate(list(AlphaDelay1_2$Alpha_Event_Number, AlphaDelay1_2$Alpha_Event_Duration), by = list(AlphaDelay1_2$Subject),mean), c("Subject", "Alpha_Event_Number","Alpha_Event_Duration"))
Avg_AlphaDelay1_2 <- merge(Avg_AlphaDelay1_2, Avg_power1_2, by = "Subject")


Avg_AlphaDelay2_3 <- setNames(aggregate(list(AlphaDelay2_3$Alpha_Event_Number, AlphaDelay2_3$Alpha_Event_Duration), by = list(AlphaDelay2_3$Subject),mean), c("Subject", "Alpha_Event_Number","Alpha_Event_Duration"))
Avg_AlphaDelay2_3 <- merge(Avg_AlphaDelay2_3, Avg_power2_3, by = "Subject")


Avg_AlphaDelay3_4 <- setNames(aggregate(list(AlphaDelay3_4$Alpha_Event_Number, AlphaDelay3_4$Alpha_Event_Duration), by = list(AlphaDelay3_4$Subject),mean), c("Subject", "Alpha_Event_Number","Alpha_Event_Duration"))
Avg_AlphaDelay3_4 <- merge(Avg_AlphaDelay3_4, Avg_power3_4, by = "Subject")


Avg_AlphaDelay4_5 <- setNames(aggregate(list(AlphaDelay4_5$Alpha_Event_Number, AlphaDelay4_5$Alpha_Event_Duration), by = list(AlphaDelay4_5$Subject),mean), c("Subject",  "Alpha_Event_Number","Alpha_Event_Duration"))
Avg_AlphaDelay4_5 <- merge(Avg_AlphaDelay4_5, Avg_power4_5, by = "Subject")


Avg_AlphaDelay5_6 <- setNames(aggregate(list( AlphaDelay5_6$Alpha_Event_Number, AlphaDelay5_6$Alpha_Event_Duration), by = list(AlphaDelay5_6$Subject),mean), c("Subject", "Alpha_Event_Number","Alpha_Event_Duration"))
Avg_AlphaDelay5_6 <- merge(Avg_AlphaDelay5_6, Avg_power5_6, by = "Subject")


Avg_AlphaDelay1_2$epoch <- "1-2"
Avg_AlphaDelay2_3$epoch <- "2-3"
Avg_AlphaDelay3_4$epoch <- "3-4"
Avg_AlphaDelay4_5$epoch <- "4-5"
Avg_AlphaDelay5_6$epoch <- "5-6"

allDelayAlpha <- rbind(Avg_AlphaDelay1_2, Avg_AlphaDelay2_3)
allDelayAlpha <- rbind(allDelayAlpha, Avg_AlphaDelay3_4)
allDelayAlpha <- rbind(allDelayAlpha, Avg_AlphaDelay4_5)
allDelayAlpha <- rbind(allDelayAlpha, Avg_AlphaDelay5_6)
allDelayAlpha <- merge(allDelayAlpha, agefile, by = "Subject")
allDelayAlpha <- subset(allDelayAlpha, visitno < 2)

DelayAlphabyGroup <- setNames(aggregate(list(allDelayAlpha$log10_Alpha_Trial_Power, allDelayAlpha$Alpha_Event_Number, allDelayAlpha$Alpha_Event_Duration), by = list(allDelayAlpha$Group, allDelayAlpha$epoch),mean), c("Group","Epoch", "Alpha_Trial_Power", "Alpha_Event_Number","Alpha_Event_Duration"))

ggplot(data = DelayAlphabyGroup,  aes(x = Epoch, y = Alpha_Trial_Power,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Alpha Power across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Power")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old


```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayAlphabyGroup, Alpha_Trial_Power ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayAlphabyGroup,  aes(x = Epoch, y = Alpha_Event_Number,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Number of Alpha Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Number of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old

```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayAlphabyGroup, Alpha_Event_Number ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayAlphabyGroup,  aes(x = Epoch, y = Alpha_Event_Duration,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Duration of Alpha Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Duration of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old

```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayAlphabyGroup, Alpha_Event_Duration ~ Epoch + Group)
anova(lm.model)
```

### Across Age
```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = allDelayAlpha,  aes(x = age, y = log10_Alpha_Trial_Power,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Alpha Power across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = allDelayAlpha,  aes(x = age, y = Alpha_Event_Number,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Number of Alpha Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = allDelayAlpha,  aes(x = age, y = Alpha_Event_Duration,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Duration of Alpha Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events")
```

## Theta Frequency Band 
 
```{r  echo=FALSE, message=FALSE, warning=FALSE}
ThetaDelay1_2 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay1_2/Theta_all_data.csv')
ThetaDelay2_3 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay2_3/Theta_all_data2_3.csv')
ThetaDelay3_4 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay3_4/Theta_all_data3_4.csv')
ThetaDelay4_5 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay4_5/Theta_all_data4_5.csv')
ThetaDelay5_6 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Delay5_6/Theta_all_data5_6.csv')

ThetaDelay1_2$log10_Theta_Trial_Power <- log10(ThetaDelay1_2$Theta_Trial_Power)
ThetaDelay2_3$log10_Theta_Trial_Power <- log10(ThetaDelay2_3$Theta_Trial_Power)
ThetaDelay3_4$log10_Theta_Trial_Power <- log10(ThetaDelay3_4$Theta_Trial_Power)
ThetaDelay4_5$log10_Theta_Trial_Power <- log10(ThetaDelay4_5$Theta_Trial_Power)
ThetaDelay5_6$log10_Theta_Trial_Power <- log10(ThetaDelay5_6$Theta_Trial_Power)

Avg_power1_2 <- aggregate(log10_Theta_Trial_Power~ Subject, ThetaDelay1_2[ThetaDelay1_2$Theta_Trial_Power > 0,], mean)
Avg_power2_3 <- aggregate(log10_Theta_Trial_Power~ Subject, ThetaDelay2_3[ThetaDelay2_3$Theta_Trial_Power > 0,], mean)
Avg_power3_4 <- aggregate(log10_Theta_Trial_Power~ Subject, ThetaDelay3_4[ThetaDelay3_4$Theta_Trial_Power > 0,], mean)
Avg_power4_5 <- aggregate(log10_Theta_Trial_Power~ Subject, ThetaDelay4_5[ThetaDelay4_5$Theta_Trial_Power > 0,], mean)
Avg_power5_6 <- aggregate(log10_Theta_Trial_Power~ Subject, ThetaDelay5_6[ThetaDelay5_6$Theta_Trial_Power > 0,], mean)


Avg_ThetaDelay1_2 <- setNames(aggregate(list(ThetaDelay1_2$Theta_Event_Number, ThetaDelay1_2$Theta_Event_Duration), by = list(ThetaDelay1_2$Subject),mean), c("Subject", "Theta_Event_Number","Theta_Event_Duration"))
Avg_ThetaDelay1_2 <- merge(Avg_ThetaDelay1_2, Avg_power1_2, by = "Subject")


Avg_ThetaDelay2_3 <- setNames(aggregate(list(ThetaDelay3_4$Theta_Event_Number, ThetaDelay3_4$Theta_Event_Duration), by = list(ThetaDelay3_4$Subject),mean), c("Subject", "Theta_Event_Number","Theta_Event_Duration"))
Avg_ThetaDelay2_3 <- merge(Avg_ThetaDelay2_3, Avg_power2_3, by = "Subject")


Avg_ThetaDelay3_4 <- setNames(aggregate(list(ThetaDelay3_4$Theta_Event_Number, ThetaDelay3_4$Theta_Event_Duration), by = list(ThetaDelay3_4$Subject),mean), c("Subject", "Theta_Event_Number","Theta_Event_Duration"))
Avg_ThetaDelay3_4 <- merge(Avg_ThetaDelay3_4, Avg_power3_4, by = "Subject")


Avg_ThetaDelay4_5 <- setNames(aggregate(list(ThetaDelay4_5$Theta_Event_Number, ThetaDelay4_5$Theta_Event_Duration), by = list(ThetaDelay4_5$Subject),mean), c("Subject",  "Theta_Event_Number","Theta_Event_Duration"))
Avg_ThetaDelay4_5 <- merge(Avg_ThetaDelay4_5, Avg_power4_5, by = "Subject")


Avg_ThetaDelay5_6 <- setNames(aggregate(list( ThetaDelay5_6$Theta_Event_Number, ThetaDelay5_6$Theta_Event_Duration), by = list(ThetaDelay5_6$Subject),mean), c("Subject", "Theta_Event_Number","Theta_Event_Duration"))
Avg_ThetaDelay5_6 <- merge(Avg_ThetaDelay5_6, Avg_power5_6, by = "Subject")


Avg_ThetaDelay1_2$epoch <- "1-2"
Avg_ThetaDelay2_3$epoch <- "2-3"
Avg_ThetaDelay3_4$epoch <- "3-4"
Avg_ThetaDelay4_5$epoch <- "4-5"
Avg_ThetaDelay5_6$epoch <- "5-6"

allDelayTheta <- rbind(Avg_ThetaDelay1_2, Avg_ThetaDelay2_3)
allDelayTheta <- rbind(allDelayTheta, Avg_ThetaDelay3_4)
allDelayTheta <- rbind(allDelayTheta, Avg_ThetaDelay4_5)
allDelayTheta <- rbind(allDelayTheta, Avg_ThetaDelay5_6)
allDelayTheta <- merge(allDelayTheta, agefile, by = "Subject")
allDelayTheta <- subset(allDelayTheta, visitno < 2)

DelayThetabyGroup <- setNames(aggregate(list(allDelayTheta$log10_Theta_Trial_Power, allDelayTheta$Theta_Event_Number, allDelayTheta$Theta_Event_Duration), by = list(allDelayTheta$Group, allDelayTheta$epoch),mean), c("Group","Epoch", "Theta_Trial_Power", "Theta_Event_Number","Theta_Event_Duration"))

ggplot(data = DelayThetabyGroup,  aes(x = Epoch, y = Theta_Trial_Power,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Theta Power across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Power")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old


```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayThetabyGroup, Theta_Trial_Power ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayThetabyGroup,  aes(x = Epoch, y = Theta_Event_Number,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Number of Theta Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Number of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old

```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayThetabyGroup, Theta_Event_Number ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayThetabyGroup,  aes(x = Epoch, y = Theta_Event_Duration,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Duration of Theta Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Duration of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old

```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayThetabyGroup, Theta_Event_Duration ~ Epoch + Group)
anova(lm.model)
```

### Across Age
```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = allDelayTheta,  aes(x = age, y = log10_Theta_Trial_Power,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Theta Power across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = allDelayTheta,  aes(x = age, y = Theta_Event_Number,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Number of Theta Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = allDelayTheta,  aes(x = age, y = Theta_Event_Duration,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Duration of Theta Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events")
```

## Beta Frequency Band 
 
```{r  echo=FALSE, message=FALSE, warning=FALSE}
BetaDelay1_2 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay1_2/Beta_all_data.csv')
BetaDelay2_3 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay2_3/Beta_all_data2_3.csv')
BetaDelay3_4 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay3_4/Beta_all_data3_4.csv')
BetaDelay4_5 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay4_5/Beta_all_data4_5.csv')
BetaDelay5_6 <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Delay5_6/Beta_all_data5_6.csv')

BetaDelay1_2$log10_Beta_Trial_Power <- log10(BetaDelay1_2$Beta_Trial_Power)
BetaDelay2_3$log10_Beta_Trial_Power <- log10(BetaDelay2_3$Beta_Trial_Power)
BetaDelay3_4$log10_Beta_Trial_Power <- log10(BetaDelay3_4$Beta_Trial_Power)
BetaDelay4_5$log10_Beta_Trial_Power <- log10(BetaDelay4_5$Beta_Trial_Power)
BetaDelay5_6$log10_Beta_Trial_Power <- log10(BetaDelay5_6$Beta_Trial_Power)

Avg_power1_2 <- aggregate(log10_Beta_Trial_Power~ Subject, BetaDelay1_2[BetaDelay1_2$Beta_Trial_Power > 0,], mean)
Avg_power2_3 <- aggregate(log10_Beta_Trial_Power~ Subject, BetaDelay2_3[BetaDelay2_3$Beta_Trial_Power > 0,], mean)
Avg_power3_4 <- aggregate(log10_Beta_Trial_Power~ Subject, BetaDelay3_4[BetaDelay3_4$Beta_Trial_Power > 0,], mean)
Avg_power4_5 <- aggregate(log10_Beta_Trial_Power~ Subject, BetaDelay4_5[BetaDelay4_5$Beta_Trial_Power > 0,], mean)
Avg_power5_6 <- aggregate(log10_Beta_Trial_Power~ Subject, BetaDelay5_6[BetaDelay5_6$Beta_Trial_Power > 0,], mean)


Avg_BetaDelay1_2 <- setNames(aggregate(list(BetaDelay1_2$Beta_Event_Number, BetaDelay1_2$Beta_Event_Duration), by = list(BetaDelay1_2$Subject),mean), c("Subject", "Beta_Event_Number","Beta_Event_Duration"))
Avg_BetaDelay1_2 <- merge(Avg_BetaDelay1_2, Avg_power1_2, by = "Subject")


Avg_BetaDelay2_3 <- setNames(aggregate(list(BetaDelay3_4$Beta_Event_Number, BetaDelay3_4$Beta_Event_Duration), by = list(BetaDelay3_4$Subject),mean), c("Subject", "Beta_Event_Number","Beta_Event_Duration"))
Avg_BetaDelay2_3 <- merge(Avg_BetaDelay2_3, Avg_power2_3, by = "Subject")


Avg_BetaDelay3_4 <- setNames(aggregate(list(BetaDelay3_4$Beta_Event_Number, BetaDelay3_4$Beta_Event_Duration), by = list(BetaDelay3_4$Subject),mean), c("Subject", "Beta_Event_Number","Beta_Event_Duration"))
Avg_BetaDelay3_4 <- merge(Avg_BetaDelay3_4, Avg_power3_4, by = "Subject")


Avg_BetaDelay4_5 <- setNames(aggregate(list(BetaDelay4_5$Beta_Event_Number, BetaDelay4_5$Beta_Event_Duration), by = list(BetaDelay4_5$Subject),mean), c("Subject",  "Beta_Event_Number","Beta_Event_Duration"))
Avg_BetaDelay4_5 <- merge(Avg_BetaDelay4_5, Avg_power4_5, by = "Subject")


Avg_BetaDelay5_6 <- setNames(aggregate(list( BetaDelay5_6$Beta_Event_Number, BetaDelay5_6$Beta_Event_Duration), by = list(BetaDelay5_6$Subject),mean), c("Subject", "Beta_Event_Number","Beta_Event_Duration"))
Avg_BetaDelay5_6 <- merge(Avg_BetaDelay5_6, Avg_power5_6, by = "Subject")


Avg_BetaDelay1_2$epoch <- "1-2"
Avg_BetaDelay2_3$epoch <- "2-3"
Avg_BetaDelay3_4$epoch <- "3-4"
Avg_BetaDelay4_5$epoch <- "4-5"
Avg_BetaDelay5_6$epoch <- "5-6"

allDelayBeta <- rbind(Avg_BetaDelay1_2, Avg_BetaDelay2_3)
allDelayBeta <- rbind(allDelayBeta, Avg_BetaDelay3_4)
allDelayBeta <- rbind(allDelayBeta, Avg_BetaDelay4_5)
allDelayBeta <- rbind(allDelayBeta, Avg_BetaDelay5_6)
allDelayBeta <- merge(allDelayBeta, agefile, by = "Subject")
allDelayBeta <- subset(allDelayBeta, visitno < 2)

DelayBetabyGroup <- setNames(aggregate(list(allDelayBeta$log10_Beta_Trial_Power, allDelayBeta$Beta_Event_Number, allDelayBeta$Beta_Event_Duration), by = list(allDelayBeta$Group, allDelayBeta$epoch),mean), c("Group","Epoch", "Beta_Trial_Power", "Beta_Event_Number","Beta_Event_Duration"))

ggplot(data = DelayBetabyGroup,  aes(x = Epoch, y = Beta_Trial_Power,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Beta Power across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Power")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old


```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayBetabyGroup, Beta_Trial_Power ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayBetabyGroup,  aes(x = Epoch, y = Beta_Event_Number,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Number of Beta Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Number of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old

```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayBetabyGroup, Beta_Event_Number ~ Epoch + Group)
anova(lm.model)
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = DelayBetabyGroup,  aes(x = Epoch, y = Beta_Event_Duration,  color = Group, group = Group )) + geom_point() + stat_smooth(method='lm') + ggtitle("Average Duration of Beta Events across the Delay Period") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Time") + ylab("Duration of Events")

```
Group 1: 10-15 years old, Group 2: 16- 20 years old, Group 3: 21 - 25 years old, Group 4: 26+ years old

```{r  echo=FALSE, message=FALSE, warning=FALSE}
lm.model <- lm(data=DelayBetabyGroup, Beta_Event_Duration ~ Epoch + Group)
anova(lm.model)
```

### Across Age
```{r  echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = allDelayBeta,  aes(x = age, y = log10_Beta_Trial_Power,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Beta Power across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = allDelayBeta,  aes(x = age, y = Beta_Event_Number,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Number of Beta Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
```

```{r  echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data = allDelayBeta,  aes(x = age, y = Beta_Event_Duration,  color = epoch, group = epoch )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Duration of Beta Events across Age \nfor Each Delay Epoch ") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events")
```


# Fixation Period Frequency Bands Across Age 
```{r, echo= FALSE, message = FALSE, warning = FALSE}

GammaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Gamma/Fix/Gamma_all_dataFix.csv')
AlphaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Alpha/Fix/Alpha_all_dataFix.csv')
BetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Beta/Fix/Beta_all_dataFix.csv')
ThetaT  <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Theta/Fix/Theta_all_dataFix.csv')
agefile <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/agefile.csv')
agefile$Subject <- agefile$idvalues 

GrandTable <- merge(GammaT, AlphaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, BetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, ThetaT, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
GrandTable <- merge(GrandTable, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

GrandTable$log10_Gamma_Trial_Power <- log10(GrandTable$Gamma_Trial_Power)
GrandTable$log10_Theta_Trial_Power <- log10(GrandTable$Theta_Trial_Power)
GrandTable$log10_Beta_Trial_Power <- log10(GrandTable$Beta_Trial_Power)
GrandTable$log10_Alpha_Trial_Power <- log10(GrandTable$Alpha_Trial_Power)


Behavior <- read.csv('H:/Projects/7TBrainMech/scripts/eeg/Shane/Results/Power_Analysis/Spectral_events_analysis/Behavior.csv')

Behavior$Subject <- paste0(Behavior$LunaID, '_', Behavior$ScanDate)
Behavior <- merge(Behavior, agefile, by = 'Subject', all.x = TRUE, all.y = TRUE)

Everything <- merge(GrandTable, Behavior, by = c('Subject', 'Trial'), all.x = TRUE, all.y = TRUE)
Everything$absPositionError <- abs(Everything$PositionError)

## average across trials 
#gamma
Avg_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], mean)
TrialVar_log10_gamma_power <- aggregate(log10_Gamma_Trial_Power ~ Subject, Everything[Everything$log10_Gamma_Trial_Power != '-Inf',], sd)
PerSubjectGamma <- merge(Avg_log10_gamma_power, TrialVar_log10_gamma_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectGamma <- merge(PerSubjectGamma, agefile, by= 'Subject')

Avg_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, mean)
TrialVar_gamma_duration <- aggregate(Gamma_Event_Duration ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, mean)
TrialVar_gamma_event_number <- aggregate(Gamma_Event_Number ~ Subject, Everything, sd)
PerSubjectGamma <- merge(PerSubjectGamma, Avg_gamma_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, TrialVar_gamma_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectGamma$ageInverse = 1/PerSubjectGamma$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectGamma <- merge(PerSubjectGamma, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectGamma <- merge(PerSubjectGamma, SD_Latency, by = 'Subject', suffix = c("", "_SD"))


#alpha
Avg_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], mean)
TrialVar_log10_alpha_power <- aggregate(log10_Alpha_Trial_Power ~ Subject, Everything[Everything$log10_Alpha_Trial_Power != '-Inf',], sd)
PerSubjectAlpha <- merge(Avg_log10_alpha_power, TrialVar_log10_alpha_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectAlpha <- merge(PerSubjectAlpha, agefile, by= 'Subject')

Avg_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, mean)
TrialVar_alpha_duration <- aggregate(Alpha_Event_Duration ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, mean)
TrialVar_alpha_event_number <- aggregate(Alpha_Event_Number ~ Subject, Everything, sd)
PerSubjectAlpha <- merge(PerSubjectAlpha, Avg_alpha_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, TrialVar_alpha_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectAlpha$ageInverse = 1/PerSubjectAlpha$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectAlpha <- merge(PerSubjectAlpha, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectAlpha <- merge(PerSubjectAlpha, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#theta
Avg_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], mean)
TrialVar_log10_theta_power <- aggregate(log10_Theta_Trial_Power ~ Subject, Everything[Everything$log10_Theta_Trial_Power != '-Inf',], sd)
PerSubjectTheta <- merge(Avg_log10_theta_power, TrialVar_log10_theta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectTheta <- merge(PerSubjectTheta, agefile, by= 'Subject')

Avg_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, mean)
TrialVar_theta_duration <- aggregate(Theta_Event_Duration ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, mean)
TrialVar_theta_event_number <- aggregate(Theta_Event_Number ~ Subject, Everything, sd)
PerSubjectTheta <- merge(PerSubjectTheta, Avg_theta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, TrialVar_theta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectTheta$ageInverse = 1/PerSubjectTheta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectTheta <- merge(PerSubjectTheta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectTheta <- merge(PerSubjectTheta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

#beta
Avg_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], mean)
TrialVar_log10_beta_power <- aggregate(log10_Beta_Trial_Power ~ Subject, Everything[Everything$log10_Beta_Trial_Power != '-Inf',], sd)
PerSubjectBeta <- merge(Avg_log10_beta_power, TrialVar_log10_beta_power, by = 'Subject', suffix = c("_mean", "_SD") )
PerSubjectBeta <- merge(PerSubjectBeta, agefile, by= 'Subject')

Avg_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, mean)
TrialVar_beta_duration <- aggregate(Beta_Event_Duration ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_duration, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_duration, by= 'Subject', suffix = c("", "_SD"))

Avg_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, mean)
TrialVar_beta_event_number <- aggregate(Beta_Event_Number ~ Subject, Everything, sd)
PerSubjectBeta <- merge(PerSubjectBeta, Avg_beta_event_number, by= 'Subject', suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, TrialVar_beta_event_number, by= 'Subject', suffix = c("", "_SD"))
PerSubjectBeta$ageInverse = 1/PerSubjectBeta$age

avg_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, mean)
SD_abs_PositionError <- aggregate(absPositionError ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_abs_PositionError, by= 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_abs_PositionError, by= 'Subject', suffix = c("", "_SD"))

avg_Latency <- aggregate(mgsLatency ~ Subject, Everything, mean)
SD_Latency <- aggregate(mgsLatency ~ Subject, Everything, sd)

PerSubjectBeta <- merge(PerSubjectBeta, avg_Latency, by = 'Subject',suffix = c("", "_mean"))
PerSubjectBeta <- merge(PerSubjectBeta, SD_Latency, by = 'Subject', suffix = c("", "_SD"))

```


## Gamma Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE, fig.margin = TRUE}
#gamma

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")

lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = log10_Gamma_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], log10_Gamma_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Average Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectGamma[PerSubjectGamma$visitno < 2,],  aes(x = age, y = Gamma_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Varibaility of Gamma Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectGamma[PerSubjectGamma$visitno < 2,], Gamma_Event_Number_SD ~ ageInverse)
anova(lm.model)

```


## Alpha Frequency Band

```{r, echo= FALSE, message = FALSE, warning = FALSE}
#alpha
ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = log10_Alpha_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], log10_Alpha_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Alpha Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectAlpha[PerSubjectAlpha$visitno < 2,],  aes(x = age, y = Alpha_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Alpha Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectAlpha[PerSubjectAlpha$visitno < 2,], Alpha_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Theta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = log10_Theta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], log10_Theta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Theta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectTheta[PerSubjectTheta$visitno < 2,],  aes(x = age, y = Theta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Theta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectTheta[PerSubjectTheta$visitno < 2,], Theta_Event_Number_SD ~ ageInverse)
anova(lm.model)

```

## Beta Frequency Band

```{r echo=FALSE, message=FALSE, warning=FALSE}
#alpha
ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_mean )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_mean ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = log10_Beta_Trial_Power_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Power)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], log10_Beta_Trial_Power_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration)) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Duration_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Between Trial Variability of Beta Event Duration vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Duration)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Duration_SD ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number ~ ageInverse)
anova(lm.model)

ggplot(data = PerSubjectBeta[PerSubjectBeta$visitno < 2,],  aes(x = age, y = Beta_Event_Number_SD )) + geom_point() + stat_smooth(method='lm',  formula='y~I(1/x)')+ ggtitle("Between Trial Variability of Beta Event Number vs Age") + theme(plot.title = element_text(hjust = 0.5))+ xlab("Age") + ylab("SD(Number of Events)")
lm.model <- lm(data=PerSubjectBeta[PerSubjectBeta$visitno < 2,], Beta_Event_Number_SD ~ ageInverse)
anova(lm.model)
```


# Comparing Fixation Period to Delay Period

```{r, echo= FALSE, message = FALSE, warning = FALSE}

#Average Delay Period Epochs together 
delayGamma <- setNames(aggregate(list(allDelayGamma$log10_Gamma_Trial_Power, allDelayGamma$Gamma_Event_Number, allDelayGamma$Gamma_Event_Duration), by = list(allDelayGamma$Subject),mean), c("Subject", "Gamma_Trial_Power", "Gamma_Event_Number","Gamma_Event_Duration"))

delayAlpha <- setNames(aggregate(list(allDelayAlpha$log10_Alpha_Trial_Power, allDelayAlpha$Alpha_Event_Number, allDelayAlpha$Alpha_Event_Duration), by = list(allDelayAlpha$Subject),mean), c("Subject", "Alpha_Trial_Power", "Alpha_Event_Number","Alpha_Event_Duration"))

delayTheta <- setNames(aggregate(list(allDelayTheta$log10_Theta_Trial_Power, allDelayTheta$Theta_Event_Number, allDelayTheta$Theta_Event_Duration), by = list(allDelayTheta$Subject),mean), c("Subject", "Theta_Trial_Power", "Theta_Event_Number","Theta_Event_Duration"))

delayBeta <- setNames(aggregate(list(allDelayBeta$log10_Beta_Trial_Power, allDelayBeta$Beta_Event_Number, allDelayBeta$Beta_Event_Duration), by = list(allDelayBeta$Subject),mean), c("Subject", "Beta_Trial_Power", "Beta_Event_Number","Beta_Event_Duration"))

gammaRatio <- merge(PerSubjectGamma, delayGamma, by= "Subject", suffix = c("_Fix", "_Delay"))
AlphaRatio <- merge(PerSubjectAlpha, delayAlpha, by= "Subject", suffix = c("_Fix", "_Delay"))
ThetaRatio <- merge(PerSubjectTheta, delayTheta, by= "Subject", suffix = c("_Fix", "_Delay"))
BetaRatio <- merge(PerSubjectBeta, delayBeta, by= "Subject", suffix = c("_Fix", "_Delay"))

```

## Gamma Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = gammaRatio, aes(x = age, y = log10_Gamma_Trial_Power_mean), color = "blue") +stat_smooth(data = gammaRatio, aes(x = age, y = log10_Gamma_Trial_Power_mean), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = gammaRatio, aes(x = age, y = Gamma_Trial_Power), color = "red") + stat_smooth(data = gammaRatio, aes(x = age, y = Gamma_Trial_Power), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Trial Gamma Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = gammaRatio, aes(x = age, y = Gamma_Event_Number_Fix), color = "blue") +stat_smooth(data = gammaRatio, aes(x = age, y = Gamma_Event_Number_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = gammaRatio, aes(x = age, y = Gamma_Event_Number_Delay), color = "red") + stat_smooth(data = gammaRatio, aes(x = age, y = Gamma_Event_Number_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Number of Gamma Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = gammaRatio, aes(x = age, y = Gamma_Event_Duration_Fix), color = "blue") +stat_smooth(data = gammaRatio, aes(x = age, y = Gamma_Event_Duration_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = gammaRatio, aes(x = age, y = Gamma_Event_Duration_Delay), color = "red") + stat_smooth(data = gammaRatio, aes(x = age, y = Gamma_Event_Duration_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Duration of Gamma Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

## Alpha Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = AlphaRatio, aes(x = age, y = log10_Alpha_Trial_Power_mean), color = "blue") +stat_smooth(data = AlphaRatio, aes(x = age, y = log10_Alpha_Trial_Power_mean), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = AlphaRatio, aes(x = age, y = Alpha_Trial_Power), color = "red") + stat_smooth(data = AlphaRatio, aes(x = age, y = Alpha_Trial_Power), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Trial Alpha Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power") + theme(legend.position = "right") 


```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = AlphaRatio, aes(x = age, y = Alpha_Event_Number_Fix), color = "blue") +stat_smooth(data = AlphaRatio, aes(x = age, y = Alpha_Event_Number_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = AlphaRatio, aes(x = age, y = Alpha_Event_Number_Delay), color = "red") + stat_smooth(data = AlphaRatio, aes(x = age, y = Alpha_Event_Number_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Number of Alpha Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = AlphaRatio, aes(x = age, y = Alpha_Event_Duration_Fix), color = "blue") +stat_smooth(data = AlphaRatio, aes(x = age, y = Alpha_Event_Duration_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = AlphaRatio, aes(x = age, y = Alpha_Event_Duration_Delay), color = "red") + stat_smooth(data = AlphaRatio, aes(x = age, y = Alpha_Event_Duration_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Duration of Alpha Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

## Theta Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = ThetaRatio, aes(x = age, y = log10_Theta_Trial_Power_mean), color = "blue") +stat_smooth(data = ThetaRatio, aes(x = age, y = log10_Theta_Trial_Power_mean), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = ThetaRatio, aes(x = age, y = Theta_Trial_Power), color = "red") + stat_smooth(data = ThetaRatio, aes(x = age, y = Theta_Trial_Power), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Trial Theta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power") + theme(legend.position = "right") 


```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = ThetaRatio, aes(x = age, y = Theta_Event_Number_Fix), color = "blue") +stat_smooth(data = ThetaRatio, aes(x = age, y = Theta_Event_Number_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = ThetaRatio, aes(x = age, y = Theta_Event_Number_Delay), color = "red") + stat_smooth(data = ThetaRatio, aes(x = age, y = Theta_Event_Number_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Number of Theta Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = ThetaRatio, aes(x = age, y = Theta_Event_Duration_Fix), color = "blue") +stat_smooth(data = ThetaRatio, aes(x = age, y = Theta_Event_Duration_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = ThetaRatio, aes(x = age, y = Theta_Event_Duration_Delay), color = "red") + stat_smooth(data = ThetaRatio, aes(x = age, y = Theta_Event_Duration_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Duration of Theta Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

## Beta Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = BetaRatio, aes(x = age, y = log10_Beta_Trial_Power_mean), color = "blue") +stat_smooth(data = BetaRatio, aes(x = age, y = log10_Beta_Trial_Power_mean), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = BetaRatio, aes(x = age, y = Beta_Trial_Power), color = "red") + stat_smooth(data = BetaRatio, aes(x = age, y = Beta_Trial_Power), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Trial Beta Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power") + theme(legend.position = "right") 


```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = BetaRatio, aes(x = age, y = Beta_Event_Number_Fix), color = "blue") +stat_smooth(data = BetaRatio, aes(x = age, y = Beta_Event_Number_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = BetaRatio, aes(x = age, y = Beta_Event_Number_Delay), color = "red") + stat_smooth(data = BetaRatio, aes(x = age, y = Beta_Event_Number_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Number of Beta Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

```{r, echo= FALSE, message = FALSE, warning = FALSE}
ggplot() + geom_point(data = BetaRatio, aes(x = age, y = Beta_Event_Duration_Fix), color = "blue") +stat_smooth(data = BetaRatio, aes(x = age, y = Beta_Event_Duration_Fix), color = "blue", method='lm',  formula='y~I(1/x)') + geom_point(data = BetaRatio, aes(x = age, y = Beta_Event_Duration_Delay), color = "red") + stat_smooth(data = BetaRatio, aes(x = age, y = Beta_Event_Duration_Delay), color = "red", method = 'lm', formula = 'y~I(1/x)') + ggtitle("Average Duration of Beta Events Power vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events") + theme(legend.position = "right") 

```
Blue: Fixation. Red: Delay

# Fixation to Delay Ratio
## Gamma Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
gammaRatio$log10_Power_Ratio <- gammaRatio$log10_Gamma_Trial_Power_mean/gammaRatio$Gamma_Trial_Power 
gammaRatio$Event_Number_Ratio <- gammaRatio$Gamma_Event_Number_Fix/gammaRatio$Gamma_Event_Number_Delay
gammaRatio$Event_Duration_Ratio <- gammaRatio$Gamma_Event_Duration_Fix/gammaRatio$Gamma_Event_Duration_Delay

ggplot(data = gammaRatio[gammaRatio$visitno < 2,],  aes(x = age, y = log10_Power_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Gamma Power Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power Ratio")

ggplot(data = gammaRatio[gammaRatio$visitno < 2,],  aes(x = age, y = Event_Number_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Number of Gamma Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events Ratio")

ggplot(data = gammaRatio[gammaRatio$visitno < 2,],  aes(x = age, y = Event_Duration_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Duration of Gamma Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events Ratio")
``` 

#Alpha Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
AlphaRatio$log10_Power_Ratio <- AlphaRatio$log10_Alpha_Trial_Power_mean/AlphaRatio$Alpha_Trial_Power 
AlphaRatio$Event_Number_Ratio <- AlphaRatio$Alpha_Event_Number_Fix/AlphaRatio$Alpha_Event_Number_Delay
AlphaRatio$Event_Duration_Ratio <- AlphaRatio$Alpha_Event_Duration_Fix/AlphaRatio$Alpha_Event_Duration_Delay

ggplot(data = AlphaRatio[AlphaRatio$visitno < 2,],  aes(x = age, y = log10_Power_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Alpha Power Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power Ratio")

ggplot(data = AlphaRatio[AlphaRatio$visitno < 2,],  aes(x = age, y = Event_Number_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Number of Alpha Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events Ratio")

ggplot(data = AlphaRatio[AlphaRatio$visitno < 2,],  aes(x = age, y = Event_Duration_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Duration of Alpha Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events Ratio")

```

#Theta Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
ThetaRatio$log10_Power_Ratio <- ThetaRatio$log10_Theta_Trial_Power_mean/ThetaRatio$Theta_Trial_Power 
ThetaRatio$Event_Number_Ratio <- ThetaRatio$Theta_Event_Number_Fix/ThetaRatio$Theta_Event_Number_Delay
ThetaRatio$Event_Duration_Ratio <- ThetaRatio$Theta_Event_Duration_Fix/ThetaRatio$Theta_Event_Duration_Delay

ggplot(data = ThetaRatio[ThetaRatio$visitno < 2,],  aes(x = age, y = log10_Power_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Theta Power Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power Ratio")

ggplot(data = ThetaRatio[ThetaRatio$visitno < 2,],  aes(x = age, y = Event_Number_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Number of Theta Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events Ratio")

ggplot(data = ThetaRatio[ThetaRatio$visitno < 2,],  aes(x = age, y = Event_Duration_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Duration of Theta Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events Ratio")

```

#Beta Frequency Band
```{r, echo= FALSE, message = FALSE, warning = FALSE}
BetaRatio$log10_Power_Ratio <- BetaRatio$log10_Beta_Trial_Power_mean/BetaRatio$Beta_Trial_Power 
BetaRatio$Event_Number_Ratio <- BetaRatio$Beta_Event_Number_Fix/BetaRatio$Beta_Event_Number_Delay
BetaRatio$Event_Duration_Ratio <- BetaRatio$Beta_Event_Duration_Fix/BetaRatio$Beta_Event_Duration_Delay

ggplot(data = BetaRatio[BetaRatio$visitno < 2,],  aes(x = age, y = log10_Power_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Beta Power Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Power Ratio")

ggplot(data = BetaRatio[BetaRatio$visitno < 2,],  aes(x = age, y = Event_Number_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Number of Beta Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Number of Events Ratio")

ggplot(data = BetaRatio[BetaRatio$visitno < 2,],  aes(x = age, y = Event_Duration_Ratio )) + geom_point() + stat_smooth(method='loess',  formula='y~I(1/x)') + ggtitle("Average Trial Duration of Beta Events Fixation:Delay vs Age") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Age") + ylab("Duration of Events Ratio")

```







